import {TestBed} from '@angular/core/testing';

import {MomentService} from './moment.service';
import {UpdateResponseService} from "./update-response.service";

describe('MomentService', () => {
  let interceptor : UpdateResponseService;

  beforeEach(() => TestBed.configureTestingModule({}));

  it('should be created', () => {
    interceptor = TestBed.inject(UpdateResponseService);
    expect(interceptor).toBeTruthy();
  });

  it('should format response and remove data.attributes structure', function () {
    const example = {"data": {"posts": {"data": [{"id": "25", "attributes": {"title": "hfycjfqwsikzngrojlsw", "name": "hfycjfqwsikzngrojlswlecjs", "body": "sesfbbzavyhiklouwwtr", "comments": 0, "likes": 0, "views": 0, "createdAt": "2023-05-03T08:37:26.276Z", "updatedAt": "2023-05-03T08:37:26.276Z", "publishedAt": "2023-05-03T08:37:26.266Z", "enable": true, "banner": {"data": {"url": "https://test.com"}}, "author": {"data": {"id": 1, "attributes": {"username": "asdfasdfe", "avatarUrl": "asdwefsvsdf"}}}, "tags": {"data": [{"id": "13", "attributes": {"name": "c++"}}, {"id": "55", "attributes": {"name": "arduino"}}]}}}], "meta": {"pagination": {"total": 30}}}}};
    const expected = {"data": {"meta_posts": {"pagination": {"total": 30}}, "posts": [{"author": {"avatarUrl": "asdwefsvsdf", "id": 1, "username": "asdfasdfe"}, "banner": {"data": {"url": "https://test.com"}}, "body": "sesfbbzavyhiklouwwtr", "comments": 0, "createdAt": "2023-05-03T08:37:26.276Z", "enable": true, "id": "25", "likes": 0, "name": "hfycjfqwsikzngrojlswlecjs", "publishedAt": "2023-05-03T08:37:26.266Z", "tags": [{"id": "13", "name": "c++"}, {"id": "55", "name": "arduino"}], "title": "hfycjfqwsikzngrojlsw", "updatedAt": "2023-05-03T08:37:26.276Z", "views": 0}]}};
    expect(interceptor.formatResponseObjects(example)).toEqual(expected);
  });

  it('should format response and remove data.attributes structure (from error)', function () {
    const example = {"data": {"recentComments": [{"body": "Buen artículo, solo quería aportar algunas alternativas a nvm\n\n\n1. [fnm](https://github.com/Schniz/fnm) mi herramienta favorita\n2. [volta](https://volta.sh)", "email": null, "name": null, "user": {"data": {"id": "200", "attributes": {"username": "yacosta738", "avatarUrl": "https://avatars.githubusercontent.com/u/33158051?v=4", "__typename": "UsersPermissionsUser"}, "__typename": "UsersPermissionsUserEntity"}, "__typename": "UsersPermissionsUserEntityResponse"}, "post": {"data": {"id": "173", "attributes": {"title": "Instalar Node como un PRO", "name": "instalar-node-como-un-proswgns", "body": "Generalmente los nuevos desarrolladores que llegan a *node.js*, cuando enfrentan el desafío de instalar *node.js*, van a la clásica de instalar una versión determinada en su sistema operativo (SO). Pues en está no es la mejor forma de instalar *node.js*, la mejor forma es utilizando *nvm* (Node Virtual Manager) que permite cambiar entre versiones de *node.js* de manera muy fácil sin necesidad de desinstalar e instalar *node.js*.\n\n## ¿Qué es *nvm*?\n\n*nvm* es un gestor de versiones para *node.js*, que está diseñado para ser instalado por usuarios e invocado en un terminal. *nvm* se integra con la mayoría de los terminales existentes (sh, dash, ksh, zsh, bash, etc), en particular con las plataformas: unix, macOS y windows WSL.\n\n## Instalar *nvm*\n\nPara instalar o actualizar *nvm*, se debe ejecutar el [script de instalación](https://github.com/nvm-sh/nvm/blob/v0.39.3/install.sh). Para esto, se puede descargar dicho script o sencillamente ejecutar uno de los siguientes comandos:\n\n```\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash\n```\n```\nwget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash\n```\n\nEjecutar cualquiera de los comandos anteriores, va a descargar y ejecutar el script de manera automática. El script clona el repositorio *nvm* en la carpeta *~/.nvm* y luego agrega automáticamente la configuración de *nvm* a cada uno de los perfiles del usuario (*~/.bash_profile*, *~/.zshrc*, *~/.profile*, or *~/.bashrc*).\n\n## Enlaces\n\n- [*nvm* en github](https://github.com/nvm-sh/nvm)\n\n## Conclusiones\n\nEspero les sirva de ayuda la próxima vez que necesiten instalar *node.js* de manera local. Con *nvm* no solo lo hace mucho más sencillo, sino que nos permite transitar entre versiones de *node.js* de una manera muy fácil.\n\nCualquier dato o sugerencia extra que quieran agregar al artículo, no duden dejarlo en los comentarios.\n\n> Happy coding!!!", "__typename": "Post"}, "__typename": "PostEntity"}, "__typename": "PostEntityResponse"}, "createdAt": "2023-04-03T15:02:33.000Z", "updatedAt": "2023-04-06T12:16:08.000Z", "__typename": "Comment"}, {"body": "Hola comunidad, Les sugiero el uso de estas herramientas para el manejo de varias versiones de nodejs.\n\n1. [fnm](https://github.com/Schniz/fnm) mi herramienta favorita\n2. [volta](https://volta.sh)\n3. [nvm](https://github.com/nvm-sh/nvm)", "email": null, "name": null, "user": {"data": {"id": "200", "attributes": {"username": "yacosta738", "avatarUrl": "https://avatars.githubusercontent.com/u/33158051?v=4", "__typename": "UsersPermissionsUser"}, "__typename": "UsersPermissionsUserEntity"}, "__typename": "UsersPermissionsUserEntityResponse"}, "post": {"data": {"id": "165", "attributes": {"title": "Cómo instalar el archivo node.tar.xz en Linux?", "name": "como-instalar-el-archivo-nodetarxz-en-linuxjsynq", "body": "Pasos para descargar e instalar node en ubuntu\n\nPaso 1: descargue el archivo de node .tar.xz más reciente o recomendado desde https://nodejs.org/es/\n\no puede descargar la versión de node v16.18.0 (archivo .tar.xz) directamente desde aquí ->\n\nhttps://nodejs.org/dist/v16.18.0/node-v16.18.0-linux-x64.tar.xz\n\nPaso 2: Vaya al directorio en el que se descargó (archivo .tar.xz).\n\nEn mi caso --> /Downloads\n\nPaso 3: Actualice los repositorios del sistema\n\nsudo apt update\n\nPaso 4: Instale el paquete xz-utils\n\nsudo apt install xz-utils\n\nPaso 5: para extraer el archivo .tar.xz\n\nsudo tar -xvf nombre_del_archivo\n\nEn mi caso --> sudo tar -xvf node-v16.18.0-linux-x64.tar.xz\n\nPaso 6: sudo cp -r nombre_directorio/{bin,include,lib,share} /usr/\n\nEn mi caso --> sudo cp -r node-v16.18.0-linux-x64/{bin,include,lib,share} /usr/\n\nPaso 7: actualice la ruta export PATH=/usr/node_nombre_directorio/bin:PATH\nEn mi caso --> export PATH=/usr/node-v16.18.0-linux-x64/bin:PATH\n\nPaso 8: Comprobar la versión del node\n\nnode --versión\n\nResultado En mi caso -> v16.18.0", "__typename": "Post"}, "__typename": "PostEntity"}, "__typename": "PostEntityResponse"}, "createdAt": "2023-04-03T14:58:55.000Z", "updatedAt": "2023-04-06T12:16:08.000Z", "__typename": "Comment"},]}};
    const expected = {"data": {"recentComments": [{"__typename": "Comment", "body": "Buen artículo, solo quería aportar algunas alternativas a nvm\n\n\n1. [fnm](https://github.com/Schniz/fnm) mi herramienta favorita\n2. [volta](https://volta.sh)", "createdAt": "2023-04-03T15:02:33.000Z", "email": null, "name": null, "post": {"__typename": "Post", "body": "Generalmente los nuevos desarrolladores que llegan a *node.js*, cuando enfrentan el desafío de instalar *node.js*, van a la clásica de instalar una versión determinada en su sistema operativo (SO). Pues en está no es la mejor forma de instalar *node.js*, la mejor forma es utilizando *nvm* (Node Virtual Manager) que permite cambiar entre versiones de *node.js* de manera muy fácil sin necesidad de desinstalar e instalar *node.js*.\n\n## ¿Qué es *nvm*?\n\n*nvm* es un gestor de versiones para *node.js*, que está diseñado para ser instalado por usuarios e invocado en un terminal. *nvm* se integra con la mayoría de los terminales existentes (sh, dash, ksh, zsh, bash, etc), en particular con las plataformas: unix, macOS y windows WSL.\n\n## Instalar *nvm*\n\nPara instalar o actualizar *nvm*, se debe ejecutar el [script de instalación](https://github.com/nvm-sh/nvm/blob/v0.39.3/install.sh). Para esto, se puede descargar dicho script o sencillamente ejecutar uno de los siguientes comandos:\n\n```\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash\n```\n```\nwget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash\n```\n\nEjecutar cualquiera de los comandos anteriores, va a descargar y ejecutar el script de manera automática. El script clona el repositorio *nvm* en la carpeta *~/.nvm* y luego agrega automáticamente la configuración de *nvm* a cada uno de los perfiles del usuario (*~/.bash_profile*, *~/.zshrc*, *~/.profile*, or *~/.bashrc*).\n\n## Enlaces\n\n- [*nvm* en github](https://github.com/nvm-sh/nvm)\n\n## Conclusiones\n\nEspero les sirva de ayuda la próxima vez que necesiten instalar *node.js* de manera local. Con *nvm* no solo lo hace mucho más sencillo, sino que nos permite transitar entre versiones de *node.js* de una manera muy fácil.\n\nCualquier dato o sugerencia extra que quieran agregar al artículo, no duden dejarlo en los comentarios.\n\n> Happy coding!!!", "id": "173", "name": "instalar-node-como-un-proswgns", "title": "Instalar Node como un PRO"}, "updatedAt": "2023-04-06T12:16:08.000Z", "user": {"__typename": "UsersPermissionsUser", "avatarUrl": "https://avatars.githubusercontent.com/u/33158051?v=4", "id": "200", "username": "yacosta738"}}, {"__typename": "Comment", "body": "Hola comunidad, Les sugiero el uso de estas herramientas para el manejo de varias versiones de nodejs.\n\n1. [fnm](https://github.com/Schniz/fnm) mi herramienta favorita\n2. [volta](https://volta.sh)\n3. [nvm](https://github.com/nvm-sh/nvm)", "createdAt": "2023-04-03T14:58:55.000Z", "email": null, "name": null, "post": {"__typename": "Post", "body": "Pasos para descargar e instalar node en ubuntu\n\nPaso 1: descargue el archivo de node .tar.xz más reciente o recomendado desde https://nodejs.org/es/\n\no puede descargar la versión de node v16.18.0 (archivo .tar.xz) directamente desde aquí ->\n\nhttps://nodejs.org/dist/v16.18.0/node-v16.18.0-linux-x64.tar.xz\n\nPaso 2: Vaya al directorio en el que se descargó (archivo .tar.xz).\n\nEn mi caso --> /Downloads\n\nPaso 3: Actualice los repositorios del sistema\n\nsudo apt update\n\nPaso 4: Instale el paquete xz-utils\n\nsudo apt install xz-utils\n\nPaso 5: para extraer el archivo .tar.xz\n\nsudo tar -xvf nombre_del_archivo\n\nEn mi caso --> sudo tar -xvf node-v16.18.0-linux-x64.tar.xz\n\nPaso 6: sudo cp -r nombre_directorio/{bin,include,lib,share} /usr/\n\nEn mi caso --> sudo cp -r node-v16.18.0-linux-x64/{bin,include,lib,share} /usr/\n\nPaso 7: actualice la ruta export PATH=/usr/node_nombre_directorio/bin:PATH\nEn mi caso --> export PATH=/usr/node-v16.18.0-linux-x64/bin:PATH\n\nPaso 8: Comprobar la versión del node\n\nnode --versión\n\nResultado En mi caso -> v16.18.0", "id": "165", "name": "como-instalar-el-archivo-nodetarxz-en-linuxjsynq", "title": "Cómo instalar el archivo node.tar.xz en Linux?"}, "updatedAt": "2023-04-06T12:16:08.000Z", "user": {"__typename": "UsersPermissionsUser", "avatarUrl": "https://avatars.githubusercontent.com/u/33158051?v=4", "id": "200", "username": "yacosta738"}}]}};
    expect(interceptor.formatResponseObjects(example)).toEqual(expected);
  });
});
